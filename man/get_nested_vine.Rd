% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/get_hierarchical_vine.R
\name{get_nested_vine}
\alias{get_nested_vine}
\title{Fit nested hierarchical vine copula structure for spatial climate data}
\usage{
get_nested_vine(
  data,
  nrows,
  ncols,
  var_types = rep("c", ncol(data)),
  fixed = TRUE,
  mask = TRUE,
  bridge_var = NULL,
  ids = NULL,
  trunc_lvl = NULL,
  seed = 123,
  ...
)
}
\arguments{
\item{data}{Data frame of pseudo-observations in \verb{[0, 1]}, with columns
named as "variable.location"}

\item{nrows}{Number of rows in the spatial grid}

\item{ncols}{Number of columns in the spatial grid}

\item{var_types}{Character vector specifying marginal variable types
(e.g., "c" for continuous)}

\item{fixed}{Logical; if TRUE, fit one spatial vine structure and reuse it
for all variables}

\item{mask}{Logical; if TRUE, restrict spatial edges to neighboring locations}

\item{bridge_var}{Integer index of the spatial location used to connect
variables across levels; randomly chosen if NULL}

\item{ids}{Optional vector of location identifiers; defaults to full grid}

\item{trunc_lvl}{Integer truncation level for vine copulas}

\item{seed}{Integer random seed for reproducibility}

\item{...}{Additional arguments passed to \code{rvinecopulib::vinecop()}}
}
\value{
A list containing:
\itemize{
\item bridge_var  : Selected bridge location
\item rvs_level1  : Spatial R-vine structure(s)
\item rvs_level2  : Inter-variable R-vine structure
\item rvs_level3  : Final merged R-vine structure
\item vine_level1 : Fitted spatial vine(s), if applicable
\item vine_level2 : Fitted Level 2 vine, if requested
\item vine_level3 : Final fitted vine copula, if requested
}
}
\description{
Constructs a 3-level hierarchical R-vine copula model designed
for multivariate climate variables observed on a spatial grid.

The hierarchy consists of:
\itemize{
\item Level 1: Spatial dependence within each climate variable
\item Level 2: Inter-variable dependence at a selected bridging location
\item Level 3: Merged vine capturing full dependence structure
}
}
\examples{
data = matrix(runif(600), ncol = 6)
colnames(data) = c("tas.1", "tas.2", "tas.3", "pr.1", "pr.2", "pr.3")
test = get_nested_vine(data, nrows = 2, ncols = 2, fixed = FALSE,
                        ids = c(1,2,3), family_set = "tll", cores = 12)

}
